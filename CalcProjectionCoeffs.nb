(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     47857,       1227]
NotebookOptionsPosition[     46488,       1195]
NotebookOutlinePosition[     46901,       1212]
CellTagsIndexPosition[     46858,       1209]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mypath", "=", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "SpinWeightedSpheroidalHarmonics`"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"ClebschGordan", "::", "phy"}], "]"}], ";", 
  RowBox[{"Off", "[", 
   RowBox[{"ClebschGordan", "::", "tri"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.867484973481101*^9, 3.8674849741792707`*^9}, {
  3.923115918780559*^9, 3.923115923040238*^9}, {3.923282698773657*^9, 
  3.9232826989810038`*^9}},
 CellLabel->
  "In[509]:=",ExpressionUUID->"3681d74a-6c06-45ed-af2e-1d3a77acf355"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lmax", "=", "30"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kmax", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minl", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2", ",", "1", ",", "0", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spins", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "2"}], ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kk", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ll", "=", "0"}], ",", 
    RowBox[{"ll", "\[LessEqual]", " ", "lmax"}], ",", 
    RowBox[{"ll", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"jj", "=", "0"}], ",", 
       RowBox[{"jj", "\[LessEqual]", " ", "kmax"}], ",", 
       RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"kk", "=", 
           RowBox[{
            RowBox[{"-", "kmax"}], "-", "1"}]}], ",", 
          RowBox[{"kk", "\[LessEqual]", 
           RowBox[{"kmax", "+", "1"}]}], ",", 
          RowBox[{"kk", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"numC0c", "[", "jj", "]"}], "[", "ll", "]"}], "[", "kk",
              "]"}], "=", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"numC0s", "[", "jj", "]"}], "[", "ll", "]"}], "[", "kk",
              "]"}], "=", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"numC1c", "[", "jj", "]"}], "[", "ll", "]"}], "[", "kk",
              "]"}], "=", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"numC1s", "[", "jj", "]"}], "[", "ll", "]"}], "[", "kk",
              "]"}], "=", "0"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
    "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8674827229353733`*^9, 3.8674827239375153`*^9}, {
   3.8674827917641087`*^9, 3.867482801327239*^9}, {3.867482868706151*^9, 
   3.8674828903586884`*^9}, {3.867482942616707*^9, 3.867482947619656*^9}, {
   3.8674867330958138`*^9, 3.867486733285236*^9}, 3.9231162910082607`*^9, 
   3.9231175044043694`*^9, {3.923202650018325*^9, 3.923202651094699*^9}, {
   3.923282643317891*^9, 3.923282644128277*^9}, {3.923283378131345*^9, 
   3.923283378392561*^9}, {3.9232836601974497`*^9, 3.923283660368281*^9}, {
   3.9232854826613607`*^9, 3.923285482919498*^9}, {3.9234701414977627`*^9, 
   3.9234701416487837`*^9}, {3.953031220570331*^9, 3.9530312207593727`*^9}},
 CellLabel->
  "In[513]:=",ExpressionUUID->"a4122057-57af-4a19-8d6c-510e14afd739"],

Cell[CellGroupData[{

Cell["Projection Coefficients", "Section",
 CellChangeTimes->{{3.9232824248788958`*^9, 
  3.923282428554986*^9}},ExpressionUUID->"71c62d38-5aa7-46ef-937b-\
3f952971bf08"],

Cell[CellGroupData[{

Cell["New Method", "Subsection",
 CellChangeTimes->{{3.923135902731462*^9, 3.923135927463893*^9}, {
  3.9232823783388233`*^9, 
  3.9232823790344887`*^9}},ExpressionUUID->"613918ef-3b96-4375-ad89-\
b1a8895d2a25"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "April", " ", "2024.", " ", "Implement", " ", "the", " ", "much", " ", 
     "more", " ", "efficient", " ", "way", " ", "to", " ", "calculate", " ", 
     "these"}], ",", " ", 
    RowBox[{
     RowBox[{"using", " ", "Clebsch"}], "-", 
     RowBox[{"Gordan", " ", 
      RowBox[{"coefficients", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "We", " ", "need", " ", "to", " ", "calculate", " ", "the", " ", "arrays", 
    " ", "of", " ", "mixing", " ", 
    RowBox[{"coefficients", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"mixsin", "[", 
      RowBox[{"s1_", ",", "s2_", ",", "l_", ",", "k_", ",", "m_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"l1", "=", 
          RowBox[{"l", "+", "k"}]}], ",", 
         RowBox[{"l2", "=", "l"}], ",", 
         RowBox[{"mm", "=", "m"}], ",", 
         RowBox[{"t0", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"s1", "==", "1"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"s2", "==", "0"}], ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"t0", "=", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"2", "*", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", "*", "l2"}], "+", "1"}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", "*", "l1"}], "+", "1"}], ")"}]}]}], "]"}]}], 
             "*", 
             RowBox[{"ClebschGordan", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"l2", ",", "mm"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"l1", ",", "mm"}], "}"}]}], "]"}], "*", 
             RowBox[{"ClebschGordan", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"l2", ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"l1", ",", "0"}], "}"}]}], "]"}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"s1", "==", 
            RowBox[{"-", "1"}]}], "&&", 
           RowBox[{"s2", "==", "0"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"t0", "=", 
            RowBox[{
             RowBox[{"Sqrt", "[", 
              RowBox[{"2", "*", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", "*", "l2"}], "+", "1"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", "*", "l1"}], "+", "1"}], ")"}]}]}], "]"}], "*", 
             RowBox[{"ClebschGordan", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"l2", ",", "mm"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"l1", ",", "mm"}], "}"}]}], "]"}], "*", 
             RowBox[{"ClebschGordan", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"l2", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"l1", ",", "0"}], "}"}]}], "]"}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"s1", "==", "2"}], "&&", 
           RowBox[{"s2", "==", "0"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"t0", "=", 
            RowBox[{
             RowBox[{"Sqrt", "[", 
              RowBox[{"8", "*", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", "*", "l2"}], "+", "1"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"3", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "*", "l1"}], "+", "1"}], ")"}]}], ")"}]}]}], 
              "]"}], "*", 
             RowBox[{"ClebschGordan", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"l2", ",", "mm"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"l1", ",", "mm"}], "}"}]}], "]"}], "*", 
             RowBox[{"ClebschGordan", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"l2", ",", 
                 RowBox[{"-", "2"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"l1", ",", "0"}], "}"}]}], "]"}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"s1", "==", 
            RowBox[{"-", "2"}]}], "&&", 
           RowBox[{"s2", "==", "0"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"t0", "=", 
            RowBox[{
             RowBox[{"Sqrt", "[", 
              RowBox[{"8", "*", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", "*", "l2"}], "+", "1"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"3", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "*", "l1"}], "+", "1"}], ")"}]}], ")"}]}]}], 
              "]"}], "*", 
             RowBox[{"ClebschGordan", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"l2", ",", "mm"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"l1", ",", "mm"}], "}"}]}], "]"}], "*", 
             RowBox[{"ClebschGordan", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"l2", ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", 
                 RowBox[{"-", "2"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"l1", ",", "0"}], "}"}]}], "]"}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"s1", "==", "2"}], "&&", 
           RowBox[{"s2", "==", "1"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"t0", "=", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"2", "*", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", "*", "l2"}], "+", "1"}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "*", "l1"}], "+", "1"}], ")"}], ")"}]}]}], 
               "]"}]}], "*", 
             RowBox[{"ClebschGordan", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"l2", ",", "mm"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"l1", ",", "mm"}], "}"}]}], "]"}], "*", 
             RowBox[{"ClebschGordan", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"l2", ",", 
                 RowBox[{"-", "2"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"l1", ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "]"}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"s1", "==", 
            RowBox[{"-", "2"}]}], "&&", 
           RowBox[{"s2", "==", 
            RowBox[{"-", "1"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"t0", "=", 
            RowBox[{
             RowBox[{"Sqrt", "[", 
              RowBox[{"2", "*", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", "*", "l2"}], "+", "1"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", "*", "l1"}], "+", "1"}], ")"}], ")"}]}]}], 
              "]"}], "*", 
             RowBox[{"ClebschGordan", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"l2", ",", "mm"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"l1", ",", "mm"}], "}"}]}], "]"}], "*", 
             RowBox[{"ClebschGordan", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"l2", ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"l1", ",", "1"}], "}"}]}], "]"}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"We", " ", "also", " ", "need", " ", "the", " ", "s1"}], "==", 
          RowBox[{
           RowBox[{"-", "1"}], " ", "s2"}], "==", 
          RowBox[{
           RowBox[{"+", "1"}], " ", "case", " ", "here"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"s1", "==", 
            RowBox[{"-", "1"}]}], "&&", 
           RowBox[{"s2", "==", "1"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"t0", "=", 
            RowBox[{
             RowBox[{"Sqrt", "[", 
              RowBox[{"8", "*", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", "*", "l2"}], "+", "1"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"3", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "*", "l1"}], "+", "1"}], ")"}]}], ")"}]}]}], 
              "]"}], "*", 
             RowBox[{"ClebschGordan", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"l2", ",", "mm"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"l1", ",", "mm"}], "}"}]}], "]"}], "*", 
             RowBox[{"ClebschGordan", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"l2", ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", 
                 RowBox[{"-", "2"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"l1", ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "]"}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Done", " ", "on", " ", 
           RowBox[{
            RowBox[{"20", "/", "11"}], "/", "22"}], " ", "late", " ", 
           "night"}], ",", " ", 
          RowBox[{
          "could", " ", "be", " ", "checked", " ", "one", " ", "more", " ", 
           RowBox[{"time", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Use", " ", "the", " ", 
          RowBox[{"symmetry", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"s1", "==", "0"}], "&&", 
           RowBox[{"s2", "==", "1"}]}], ",", 
          RowBox[{
           RowBox[{"t0", "=", 
            RowBox[{"mixsin", "[", 
             RowBox[{"s2", ",", "s1", ",", 
              RowBox[{"l", "+", "k"}], ",", 
              RowBox[{"-", "k"}], ",", "m"}], "]"}]}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"s1", "==", "0"}], "&&", 
           RowBox[{"s2", "==", 
            RowBox[{"-", "1"}]}]}], ",", 
          RowBox[{
           RowBox[{"t0", "=", 
            RowBox[{"mixsin", "[", 
             RowBox[{"s2", ",", "s1", ",", 
              RowBox[{"l", "+", "k"}], ",", 
              RowBox[{"-", "k"}], ",", "m"}], "]"}]}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"s1", "==", "0"}], "&&", 
           RowBox[{"s2", "==", 
            RowBox[{"-", "2"}]}]}], ",", 
          RowBox[{
           RowBox[{"t0", "=", 
            RowBox[{"mixsin", "[", 
             RowBox[{"s2", ",", "s1", ",", 
              RowBox[{"l", "+", "k"}], ",", 
              RowBox[{"-", "k"}], ",", "m"}], "]"}]}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"s1", "==", "0"}], "&&", 
           RowBox[{"s2", "==", "2"}]}], ",", 
          RowBox[{
           RowBox[{"t0", "=", 
            RowBox[{"mixsin", "[", 
             RowBox[{"s2", ",", "s1", ",", 
              RowBox[{"l", "+", "k"}], ",", 
              RowBox[{"-", "k"}], ",", "m"}], "]"}]}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"s1", "==", "1"}], "&&", 
           RowBox[{"s2", "==", 
            RowBox[{"-", "1"}]}]}], ",", 
          RowBox[{
           RowBox[{"t0", "=", 
            RowBox[{"mixsin", "[", 
             RowBox[{"s2", ",", "s1", ",", 
              RowBox[{"l", "+", "k"}], ",", 
              RowBox[{"-", "k"}], ",", "m"}], "]"}]}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"s1", "==", "1"}], "&&", 
           RowBox[{"s2", "==", "2"}]}], ",", 
          RowBox[{
           RowBox[{"t0", "=", 
            RowBox[{"mixsin", "[", 
             RowBox[{"s2", ",", "s1", ",", 
              RowBox[{"l", "+", "k"}], ",", 
              RowBox[{"-", "k"}], ",", "m"}], "]"}]}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"s1", "==", 
            RowBox[{"-", "1"}]}], "&&", 
           RowBox[{"s2", "==", 
            RowBox[{"-", "2"}]}]}], ",", 
          RowBox[{
           RowBox[{"t0", "=", 
            RowBox[{"mixsin", "[", 
             RowBox[{"s2", ",", "s1", ",", 
              RowBox[{"l", "+", "k"}], ",", 
              RowBox[{"-", "k"}], ",", "m"}], "]"}]}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Simplify", "[", "t0", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"co", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"a", "[", "ll", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ll", ",", "0", ",", "5"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"nn", "=", "0"}], ",", 
     RowBox[{"nn", "<=", "5"}], ",", 
     RowBox[{"nn", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t0", "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"a", "[", "ll", "]"}], "*", 
          RowBox[{"SphericalHarmonicY", "[", 
           RowBox[{"ll", ",", "0", ",", "\[Theta]", ",", "0"}], "]"}]}], ",", 
         
         RowBox[{"{", 
          RowBox[{"ll", ",", "0", ",", "5"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"t1", "=", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Theta]", "]"}], "^", "nn"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"t2", "=", 
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{"t0", "-", "t1"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]", "]"}], "->", "x"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"t3", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Coefficient", "[", 
           RowBox[{"t2", ",", "x", ",", "ll"}], "]"}], "==", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"ll", ",", "0", ",", "5"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"aco", "[", "nn", "]"}], "=", 
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{"t3", ",", "co"}], "]"}], "//", "First"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CosMix", "[", 
      RowBox[{"s_", ",", "n_", ",", "l_", ",", "k_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"l1", "=", 
          RowBox[{"l", "+", "k"}]}], ",", 
         RowBox[{"l2", "=", "l"}], ",", 
         RowBox[{"ss", "=", "s"}], ",", 
         RowBox[{"t0", "=", "0"}], ",", "j", ",", "tmp"}], "}"}], ",", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "*", 
            RowBox[{"KroneckerDelta", "[", 
             RowBox[{"l1", ",", "l2"}], "]"}], "*", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"4", "*", "\[Pi]"}], "]"}], ")"}]}]}], "+", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "[", "j", "]"}], "*", 
              RowBox[{"Sqrt", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", "*", "j"}], "+", "1"}], ")"}], "*", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", "*", "l2"}], "+", "1"}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{"4", "*", "\[Pi]", "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "l1"}], "+", "1"}], ")"}]}], ")"}]}]}], 
               "]"}], "*", 
              RowBox[{"ClebschGordan", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"l2", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"l1", ",", "0"}], "}"}]}], "]"}], "*", 
              RowBox[{"ClebschGordan", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"l2", ",", 
                  RowBox[{"-", "s"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"l1", ",", 
                  RowBox[{"-", "s"}]}], "}"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "5"}], "}"}]}], "]"}]}], "//", 
          "Simplify"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Simplify", "[", 
         RowBox[{"tmp", "/.", 
          RowBox[{"aco", "[", "n", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SinMix", "[", 
      RowBox[{"s_", ",", "n_", ",", "l_", ",", "k_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"l1", "=", 
          RowBox[{"l", "+", "k"}]}], ",", 
         RowBox[{"l2", "=", "l"}], ",", 
         RowBox[{"ss", "=", "s"}], ",", "j", ",", "tmp", ",", "t0", ",", "t1",
          ",", "t2"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"s", "==", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"t0", "=", 
            RowBox[{
             RowBox[{"mixsin", "[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "0", ",", "l", ",", "1", ",", "0"}], 
              "]"}], "*", 
             RowBox[{"CosMix", "[", 
              RowBox[{"0", ",", "n", ",", 
               RowBox[{"l", "+", "1"}], ",", 
               RowBox[{"k", "-", "1"}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"t1", "=", 
            RowBox[{
             RowBox[{"mixsin", "[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "0", ",", "l", ",", 
               RowBox[{"-", "1"}], ",", "0"}], "]"}], "*", 
             RowBox[{"CosMix", "[", 
              RowBox[{"0", ",", "n", ",", 
               RowBox[{"l", "-", "1"}], ",", 
               RowBox[{"k", "+", "1"}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{
             RowBox[{"Sqrt", "[", 
              RowBox[{"l", "*", 
               RowBox[{"(", 
                RowBox[{"l", "+", "1"}], ")"}]}], "]"}], "*", 
             RowBox[{"(", 
              RowBox[{"t0", "+", "t1"}], ")"}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"s", "==", 
           RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"t0", "=", 
             RowBox[{
              RowBox[{"mixsin", "[", 
               RowBox[{
                RowBox[{"-", "2"}], ",", 
                RowBox[{"-", "1"}], ",", "l", ",", "1", ",", "0"}], "]"}], 
              "*", 
              RowBox[{"CosMix", "[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "n", ",", 
                RowBox[{"l", "+", "1"}], ",", 
                RowBox[{"k", "-", "1"}]}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"t1", "=", 
             RowBox[{
              RowBox[{"mixsin", "[", 
               RowBox[{
                RowBox[{"-", "2"}], ",", 
                RowBox[{"-", "1"}], ",", "l", ",", 
                RowBox[{"-", "1"}], ",", "0"}], "]"}], "*", 
              RowBox[{"CosMix", "[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "n", ",", 
                RowBox[{"l", "-", "1"}], ",", 
                RowBox[{"k", "+", "1"}]}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"t2", "=", 
             RowBox[{"CosMix", "[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{"n", "+", "1"}], ",", "l", ",", "k"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"tmp", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"l", "-", "1"}], ")"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"l", "+", "2"}], ")"}]}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{"t0", "+", "t1"}], ")"}]}], "+", "t2"}]}], ";"}], 
           "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"t0", "=", 
            RowBox[{
             RowBox[{"mixsin", "[", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}], ",", "l", ",", "1", ",", "0"}], "]"}], "*", 
             RowBox[{"CosMix", "[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "n", ",", 
               RowBox[{"l", "+", "1"}], ",", 
               RowBox[{"k", "-", "1"}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"t1", "=", 
            RowBox[{
             RowBox[{"mixsin", "[", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}], ",", "l", ",", 
               RowBox[{"-", "1"}], ",", "0"}], "]"}], "*", 
             RowBox[{"CosMix", "[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "n", ",", 
               RowBox[{"l", "-", "1"}], ",", 
               RowBox[{"k", "+", "1"}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"t2", "=", 
            RowBox[{"CosMix", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", 
              RowBox[{"n", "+", "1"}], ",", "l", ",", "k"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"tmp", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"l", "*", 
                 RowBox[{"(", 
                  RowBox[{"l", "+", "1"}], ")"}]}], "]"}]}], "*", 
              RowBox[{"(", 
               RowBox[{"t0", "+", "t1"}], ")"}]}], "-", "t2"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Simplify", "[", "tmp", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.92311602413023*^9, 3.9231160527093163`*^9}, {
   3.9231162334845457`*^9, 3.923116264668976*^9}, {3.9231164386669407`*^9, 
   3.9231164392068996`*^9}, {3.923116683193822*^9, 3.923116689361309*^9}, {
   3.923116824963204*^9, 3.923116848887516*^9}, {3.9231359158812723`*^9, 
   3.923135925225842*^9}, {3.9232786449414387`*^9, 3.923278791397214*^9}, {
   3.923278832056789*^9, 3.923278917480377*^9}, {3.923278973376051*^9, 
   3.923278974648353*^9}, {3.9232816159329*^9, 3.923281682335273*^9}, 
   3.9232817151396646`*^9, {3.923281836205435*^9, 3.923281916369788*^9}, {
   3.9232821484901114`*^9, 3.923282148764373*^9}, {3.9232821923541317`*^9, 
   3.923282199715393*^9}, {3.923282929776568*^9, 3.923282930388461*^9}, {
   3.923283441465972*^9, 3.923283450134749*^9}, {3.9232849703941517`*^9, 
   3.9232850222641573`*^9}, {3.9232851747536173`*^9, 3.92328517499741*^9}, {
   3.9232852388981256`*^9, 3.923285251266527*^9}},
 CellLabel->
  "In[519]:=",ExpressionUUID->"c3113e87-78f7-491f-a324-cadb69ad84ca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tbl", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"ll", "=", "0"}], ",", 
      RowBox[{"ll", "\[LessEqual]", " ", "lmax"}], ",", 
      RowBox[{"ll", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"jj", "=", "0"}], ",", 
         RowBox[{"jj", "\[LessEqual]", " ", "kmax"}], ",", 
         RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"kk", "=", 
             RowBox[{
              RowBox[{"-", "jj"}], "-", "1"}]}], ",", 
            RowBox[{"kk", "\[LessEqual]", " ", 
             RowBox[{"jj", "+", "1"}]}], ",", 
            RowBox[{"kk", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"val", "=", "0"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"ll", "+", "kk"}], "\[GreaterEqual]", "0"}], "&&", 
                RowBox[{
                 RowBox[{"ll", "+", "kk"}], "<=", "lmax"}], "&&", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"jj", "+", "kk"}], ",", "2"}], "]"}], "==", 
                 "0"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"val", "=", 
                 RowBox[{"CosMix", "[", 
                  RowBox[{"0", ",", "jj", ",", "ll", ",", "kk"}], "]"}]}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"tbl", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"C0c", "[", "jj", "]"}], "[", "ll", "]"}], "[", 
                 "kk", "]"}], "\[Rule]", "val"}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"val", "=", "0"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"ll", "+", "kk"}], "\[GreaterEqual]", "0"}], "&&", 
                RowBox[{
                 RowBox[{"ll", "+", "kk"}], "<=", "lmax"}], "&&", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"jj", "+", "kk"}], ",", "2"}], "]"}], "==", 
                 "1"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"val", "=", 
                 RowBox[{"SinMix", "[", 
                  RowBox[{"0", ",", "jj", ",", "ll", ",", "kk"}], "]"}]}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"tbl", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"C0s", "[", "jj", "]"}], "[", "ll", "]"}], "[", 
                 "kk", "]"}], "->", "val"}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"val", "=", "0"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"ll", "+", "kk"}], "\[GreaterEqual]", "1"}], "&&", 
                RowBox[{
                 RowBox[{"ll", "+", "kk"}], "<=", "lmax"}], "&&", 
                RowBox[{"ll", "\[GreaterEqual]", " ", "1"}], "&&", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"jj", "+", "kk"}], ",", "2"}], "]"}], "==", 
                 "0"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"val", "=", 
                 RowBox[{"CosMix", "[", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "jj", ",", "ll", ",", "kk"}], 
                  "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"tbl", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"C1c", "[", "jj", "]"}], "[", "ll", "]"}], "[", 
                 "kk", "]"}], "->", "val"}]}], "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"val", "=", "0"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"ll", "+", "kk"}], "\[GreaterEqual]", "1"}], "&&", 
                RowBox[{
                 RowBox[{"ll", "+", "kk"}], "<=", "lmax"}], "&&", 
                RowBox[{"ll", "\[GreaterEqual]", " ", "1"}], "&&", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"jj", "+", "kk"}], ",", "2"}], "]"}], "==", 
                 "1"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"val", "=", 
                 RowBox[{"SinMix", "[", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "jj", ",", "ll", ",", "kk"}], 
                  "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"tbl", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"C1s", "[", "jj", "]"}], "[", "ll", "]"}], "[", 
                 "kk", "]"}], "->", "val"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
   "\[IndentingNewLine]", ",", "ll"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9232824850498466`*^9, 3.923282505031702*^9}, {
  3.923282556107819*^9, 3.923282601666127*^9}, {3.9232833614755907`*^9, 
  3.923283372914991*^9}, {3.923283456673361*^9, 3.923283468813793*^9}},
 CellLabel->
  "In[524]:=",ExpressionUUID->"3f99e141-21ff-46ad-bed5-74c21aab2fdc"],

Cell[BoxData[
 RowBox[{"Put", "[", 
  RowBox[{"tbl", ",", 
   RowBox[{"mypath", "<>", "\"\<static/ProjCo.m\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.923282662747052*^9, {3.923282813647039*^9, 3.923282817492399*^9}, 
   3.923283511122511*^9},
 CellLabel->
  "In[526]:=",ExpressionUUID->"ed21d396-aefd-46a2-b477-d4ddbdfe71a0"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Trace", "Section",
 CellChangeTimes->{{3.9232823959200583`*^9, 
  3.923282396447915*^9}},ExpressionUUID->"6b9b3766-fef5-4b69-93d6-\
53786a4c7423"],

Cell[CellGroupData[{

Cell["New method", "Subsection",
 CellChangeTimes->{{3.923284139898382*^9, 
  3.9232841419197397`*^9}},ExpressionUUID->"3c449b0c-24f3-4684-a32b-\
84e38426be1a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ll", "=", "0"}], ",", 
    RowBox[{"ll", "\[LessEqual]", " ", "lmax"}], ",", 
    RowBox[{"ll", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"kk", "=", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{"kk", "\[LessEqual]", "1"}], ",", 
       RowBox[{"kk", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"numb", "[", "ll", "]"}], "[", "kk", "]"}], "=", "0"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"numc", "[", "ll", "]"}], "[", "kk", "]"}], "=", "0"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"ll", "=", "0"}], ",", 
      RowBox[{"ll", "\[LessEqual]", " ", "lmax"}], ",", 
      RowBox[{"ll", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"kk", "=", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"kk", "\[LessEqual]", " ", "1"}], ",", 
         RowBox[{"kk", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ll", "+", 
              RowBox[{"2", "*", "kk"}]}], "\[GreaterEqual]", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"numc", "[", "ll", "]"}], "[", "kk", "]"}], "=", 
              RowBox[{"CosMix", "[", 
               RowBox[{"0", ",", "2", ",", "ll", ",", 
                RowBox[{"2", "*", "kk"}]}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"numc", "[", "ll", "]"}], "[", "kk", "]"}], "=", 
              RowBox[{
               RowBox[{"2", "*", "\[Pi]", "*", 
                RowBox[{"Integrate", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sin", "[", "\[Theta]", "]"}], "*", 
                   RowBox[{
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], "^", "2"}], "*", 
                   RowBox[{"SphericalHarmonicY", "[", 
                    RowBox[{
                    RowBox[{"ll", "+", 
                    RowBox[{"2", "*", "kk"}]}], ",", "0", ",", "\[Theta]", 
                    ",", "0"}], "]"}], "*", 
                   RowBox[{"SphericalHarmonicY", "[", 
                    RowBox[{"ll", ",", "0", ",", "\[Theta]", ",", "0"}], 
                    "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}]}], 
                 "]"}]}], "//", "Simplify"}]}], ";"}], "*)"}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"ll", "+", 
               RowBox[{"2", "*", "kk"}]}], ">", "0"}], "&&", 
             RowBox[{"ll", ">", "0"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"numb", "[", "ll", "]"}], "[", "kk", "]"}], "=", 
              RowBox[{
               RowBox[{
                RowBox[{"Sqrt", "[", 
                 RowBox[{"ll", "*", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"ll", "+", "1"}], ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ll", "+", 
                    RowBox[{"2", "*", "kk"}]}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"ll", "+", 
                    RowBox[{"2", "*", "kk"}], "+", "1"}], ")"}]}], ")"}]}]}], 
                 "]"}], "*", 
                RowBox[{"CosMix", "[", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "2", ",", "ll", ",", 
                  RowBox[{"2", "*", "kk"}]}], "]"}]}], "//", "Simplify"}]}], 
             ";"}]}], "\[IndentingNewLine]", 
           RowBox[{"(*", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"numb", "[", "ll", "]"}], "[", "kk", "]"}], "=", 
              RowBox[{
               RowBox[{
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"ll", "+", 
                    RowBox[{"2", "*", "kk"}]}], ")"}], "*", 
                   RowBox[{"(", 
                    RowBox[{"ll", "+", 
                    RowBox[{"2", "*", "kk"}], "+", "1"}], ")"}]}], ")"}]}], 
                "*", "2", "*", "\[Pi]", "*", 
                RowBox[{"Integrate", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sin", "[", "\[Theta]", "]"}], "*", 
                   RowBox[{
                    RowBox[{"Cos", "[", "\[Theta]", "]"}], "^", "2"}], "*", 
                   RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"SphericalHarmonicY", "[", 
                    RowBox[{
                    RowBox[{"ll", "+", 
                    RowBox[{"2", "*", "kk"}]}], ",", "0", ",", "\[Theta]", 
                    ",", "0"}], "]"}], ",", "\[Theta]"}], "]"}], "*", 
                   RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"SphericalHarmonicY", "[", 
                    RowBox[{"ll", ",", "0", ",", "\[Theta]", ",", "0"}], 
                    "]"}], ",", "\[Theta]"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}]}], 
                 "]"}]}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
            "*)"}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
    ";"}], "\[IndentingNewLine]", ",", "ll"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tbl", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ll", "=", "0"}], ",", 
    RowBox[{"ll", "\[LessEqual]", " ", "lmax"}], ",", 
    RowBox[{"ll", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"kk", "=", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{"kk", "\[LessEqual]", " ", "1"}], ",", 
       RowBox[{"kk", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"tbl", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"bco", "[", "ll", "]"}], "[", "kk", "]"}], "\[Rule]", " ", 
           RowBox[{
            RowBox[{"numb", "[", "ll", "]"}], "[", "kk", "]"}]}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"tbl", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"cco", "[", "ll", "]"}], "[", "kk", "]"}], "\[Rule]", " ", 
           RowBox[{
            RowBox[{"numc", "[", "ll", "]"}], "[", "kk", "]"}]}]}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"tbl", ";"}], "\[IndentingNewLine]", 
 RowBox[{"Put", "[", 
  RowBox[{"tbl", ",", 
   RowBox[{"mypath", "<>", "\"\<static/TraceCo.m\>\""}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9232841867878113`*^9, 3.923284187697351*^9}, {
  3.923284234052376*^9, 3.923284448758478*^9}, {3.923284516509348*^9, 
  3.923284517545435*^9}},
 CellLabel->
  "In[527]:=",ExpressionUUID->"8e927ded-de67-43d8-9839-41a47e10a72e"]
}, Closed]]
}, Open  ]]
},
Evaluator->"K3",
WindowSize->{915, 911},
WindowMargins->{{Automatic, 433}, {Automatic, 0}},
FrontEndVersion->"13.0 for Mac OS X x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"6949eaf4-baca-4ca7-b12a-670a5ed2be07"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 733, 17, 115, "Input",ExpressionUUID->"3681d74a-6c06-45ed-af2e-1d3a77acf355"],
Cell[1294, 39, 3001, 73, 325, "Input",ExpressionUUID->"a4122057-57af-4a19-8d6c-510e14afd739"],
Cell[CellGroupData[{
Cell[4320, 116, 170, 3, 67, "Section",ExpressionUUID->"71c62d38-5aa7-46ef-937b-3f952971bf08"],
Cell[CellGroupData[{
Cell[4515, 123, 211, 4, 54, "Subsection",ExpressionUUID->"613918ef-3b96-4375-ad89-b1a8895d2a25"],
Cell[4729, 129, 26767, 692, 1690, "Input",ExpressionUUID->"c3113e87-78f7-491f-a324-cadb69ad84ca"],
Cell[31499, 823, 6313, 146, 682, "Input",ExpressionUUID->"3f99e141-21ff-46ad-bed5-74c21aab2fdc"],
Cell[37815, 971, 333, 8, 30, "Input",ExpressionUUID->"ed21d396-aefd-46a2-b477-d4ddbdfe71a0"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[38197, 985, 152, 3, 67, "Section",ExpressionUUID->"6b9b3766-fef5-4b69-93d6-53786a4c7423"],
Cell[CellGroupData[{
Cell[38374, 992, 160, 3, 54, "Subsection",ExpressionUUID->"3c449b0c-24f3-4684-a32b-84e38426be1a"],
Cell[38537, 997, 7923, 194, 804, "Input",ExpressionUUID->"8e927ded-de67-43d8-9839-41a47e10a72e"]
}, Closed]]
}, Open  ]]
}
]
*)

